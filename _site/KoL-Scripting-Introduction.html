<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Begin Jekyll SEO tag v2.7.1 -->
    <title>Introduction | KoL Scripting Resources</title>
    <meta name="generator" content="Jekyll v3.9.0" />
    <meta property="og:title" content="Introduction" />
    <meta name="author" content="L. A. S. S." />
    <meta property="og:locale" content="en_US" />
    <meta
      name="description"
      content="A grand array of resources for Junior Associate Loathing Engineer Newbies"
    />
    <meta
      property="og:description"
      content="A grand array of resources for Junior Associate Loathing Engineer Newbies"
    />
    <link
      rel="canonical"
      href="http://localhost:4000/KoL-Scripting-Introduction.html"
    />
    <meta
      property="og:url"
      content="http://localhost:4000/KoL-Scripting-Introduction.html"
    />
    <meta property="og:site_name" content="KoL Scripting Resources" />
    <meta name="twitter:card" content="summary" />
    <meta property="twitter:title" content="Introduction" />
    <script type="application/ld+json">
      {
        "author": { "@type": "Person", "name": "L. A. S. S." },
        "@type": "WebPage",
        "headline": "Introduction",
        "description": "A grand array of resources for Junior Associate Loathing Engineer Newbies",
        "url": "http://localhost:4000/KoL-Scripting-Introduction.html",
        "@context": "https://schema.org"
      }
    </script>
    <!-- End Jekyll SEO tag -->

    <link
      rel="stylesheet"
      href="/assets/css/style.css?v=d2cffd5bf905ff3e1f36907cc6ca601daeff4419"
    />
    <!--[if lt IE 9]>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

    <!-- Setup Google Analytics -->

    <!-- You can set your favicon here -->
    <!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

    <!-- end custom head snippets -->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1><a href="http://localhost:4000/">KoL Scripting Resources</a></h1>

        <nav>
          <ul>
            <li><a href="/">Home</a></li>

            <li>
              <a href="KoL-Scripting-Introduction.html"
                >An Introduction to KOL Scripting</a
              >
            </li>

            <li>
              <a href="">Lists of Scripts</a>
              <ul>
                <li>
                  <a href="CS-Scripting-Resources.html"
                    >Community Service Scripts</a
                  >
                </li>
              </ul>
            </li>
          </ul>
        </nav>

        <!-- 
        

        <p>A grand array of resources for Junior Associate Loathing Engineer Newbies</p>

        
        <p class="view"><a href="https://github.com/Loathing-Associates-Scripting-Society/KoL-Scripting-Resources">View the Project on GitHub <small>Loathing-Associates-Scripting-Society/KoL-Scripting-Resources</small></a></p>
        

        

         -->
      </header>
      <section>
        <h1 id="introduction">Introduction</h1>
        <h2 id="why-script-kol">Why script KoL?</h2>
        <p>
          When the Kingdom of Loathing (KoL) was first created, it was designed
          to be a game you could play during your coffee break. Each day you
          have 40 adventures, and you can spend them fighting Knob Goblins or
          Fiendish Cans of Asparagus or crafting advanced cocktails. At this
          point, however, KoL has evolved into a game of enormous scope. You may
          have thousands of turns to play in a day. You may have hundreds of
          resources to use. For many players, it is impractical to try to do
          everything by hand.
        </p>

        <p>
          If you’re reading this, you probably already use
          <a href="https://wiki.kolmafia.us/index.php/KoLmafia_Guide"
            >KoLMafia</a
          >. It’s a fantastic tool to help play turns quickly and efficiently.
          With scripts written in ASH or JavaScript, you can have KoLMafia make
          gameplay decisions for you and execute them: you can automate
          adventuring, inventory management, and even KMails. Hell, you’ve
          probably already used some scripts–<a
            href="https://github.com/Loathing-Associates-Scripting-Society/autoscend"
            >autoscend</a
          >
          and
          <a
            href="https://github.com/Loathing-Associates-Scripting-Society/garbage-collector"
            >garbage collector</a
          >
          are two popular scripts that we here at LASS produce, and there are
          dozens of other scripts that help automate play, simplify resources,
          and make the game a better experience for everyone.
        </p>

        <p>
          That all being said, everyone’s specific needs and goals are
          different. There is probably something you’d like to do that is not
          currently supported by a script. Maybe you have a great idea for
          improving an existing script, or maybe you need to automate a task
          that no one has a public script that does. Whatever you need to do in
          this game, there’s probably a way to make it better by scripting it.
        </p>

        <p>I think dogs should be able to vote.</p>

        <h2 id="what-are-the-tools-and-resources-available-for-scripting-kol">
          What are the tools and resources available for scripting KoL?
        </h2>
        <p>
          There are a number of useful resources you should leverage as you
          start learning about scripting in KoL:
        </p>
        <ul>
          <li>
            The
            <a href="https://wiki.kolmafia.us/index.php/Main_Page"
              >KoLMafia wiki</a
            >
            has documentation for most existing functions used in Mafia scripts
          </li>
          <li>
            KoLMafia can read scripts written in ASH or Javascript, so anything
            that supports writing those is a good tool; the rest of this page
            will discuss these languages
          </li>
          <li>
            <a href="https://code.visualstudio.com/">Visual Studio Code</a> is a
            popular software for scriptwriting that offers, among other things,
            syntax highlighting and source control; it’s highly recommended for
            your development environment!
          </li>
          <li>
            Sometimes, the best way to learn is to read scripts made by others.
            You can find a wealth of these on the
            <a href="https://kolmafia.us/#repository.3">KOLMafia Forums</a> or
            on the
            <a href="https://github.com/Loathing-Associates-Scripting-Society/"
              >LASS GitHub</a
            >.
          </li>
          <li>
            Another great place to learn is to visit the
            <a href="https://discord.com/invite/k3vR3caDkF"
              >Ascension Speed Society Discord</a
            >; the #mafia-and-scripting channel is full of helpful folk who’d be
            happy to show you the ropes.
          </li>
        </ul>

        <h1 id="ash--javascript">ASH &amp; Javascript</h1>

        <ul>
          <li>
            ASH is a specific-use KoL language that was built by KoLMafia’s
            developers, starting with
            <a
              href="http://forums.kingdomofloathing.com/vb/showthread.php?t=88408"
              >Mafia’s inception in 2005</a
            >
            and being improved and maintained since
          </li>
          <li>
            Javascript is a fundamental programming language used across the
            internet, primarily for backend webpage functionality and is
            supported for code execution in all major browsers
          </li>
        </ul>

        <p>
          Here are some basic, one-line tasks that you might do in ASH or JS.
        </p>

        <table>
          <thead>
            <tr>
              <th>Syntax</th>
              <th>ASH</th>
              <th>Javascript</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Look up an item</td>
              <td>
                <code class="language-plaintext highlighter-rouge"
                  >$item[squirming slime larva]</code
                >
              </td>
              <td>
                <code class="language-plaintext highlighter-rouge"
                  >Item.get("squirming slime larva")</code
                >
              </td>
            </tr>
            <tr>
              <td>Restore MP</td>
              <td>
                <code class="language-plaintext highlighter-rouge"
                  >restore_mp(69)</code
                >
              </td>
              <td>
                <code class="language-plaintext highlighter-rouge"
                  >restoreMp(69)</code
                >
              </td>
            </tr>
            <tr>
              <td>Buy a Big Rock</td>
              <td>
                <code class="language-plaintext highlighter-rouge"
                  >buy(1, $item[big rock])</code
                >
              </td>
              <td>
                <code class="language-plaintext highlighter-rouge"
                  >buy(1, Item.get("big rock")</code
                >
              </td>
            </tr>
          </tbody>
        </table>

        <p>
          Here’s an example of a more complex task: returning all one-handed
          weapons that you have, sorted by familiar weight. In Javascript, this
          would look like:
        </p>
        <div class="language-plaintext highlighter-rouge">
          <div class="highlight">
            <pre class="highlight"><code>Item.all()
  .filter((item) =&gt; availableAmount(item) &gt; 0 &amp;&amp; weaponHands(item) === 1)
  .sort((a, b) =&gt; numericModifier(b, "Familiar Weight") - numericModifier(a, "Familiar Weight"));
</code></pre>
          </div>
        </div>
        <p>In ASH, the same task would look like</p>
        <div class="language-plaintext highlighter-rouge">
          <div class="highlight">
            <pre
              class="highlight"
            ><code>item[int] weapons_by_fam_lbs;		//our desired output
int count;			//how many items meet our criteria? will be used as the key
//first we want to go through all items and list those who meet our requirement
foreach it in $items[]	//go through all items one by one
{
	if(available_amount(it) == 0 || weaponHands(it) != 1) continue;		//skip this item as it fails our criteria
	weapons_by_fam_lbs[count] = it;
	count++;
}
//next we sort it
sort weapons_by_fam_lbs by numericModifier(value, "Familiar Weight");
</code></pre>
          </div>
        </div>
        <h2 id="ash">ASH</h2>
        <h3 id="using-common-ash-functions-via-example">
          Using Common ASH Functions (via Example)
        </h3>
        <p>
          There are a number of useful starter ASH tutorials on the KoLMafia
          wiki and scattered about Mafia’s old home on sourceforge. One that I
          find particularly useful is
          <a href="https://kolmafia.sourceforge.io/advanced.html"
            >this set of two basic examples of ASH scripts</a
          >. At a high level, when thinking about how to use ASH (or, really,
          any new programming language), the best way to go about it is to start
          with a small abstract piece of something useful and extend your reach
          beyond it by bringing in things that add complication and heft to the
          initial goal. As a start, let’s use a very simple, very effective
          use-case: drinking a nightcap, via the “drink” command.
        </p>
        <div class="language-plaintext highlighter-rouge">
          <div class="highlight">
            <pre class="highlight"><code>drink(1,$item[emergency margarita]);
</code></pre>
          </div>
        </div>
        <p>
          This is easy and straightforward. You could simply save this as
          nightCap.ash, run it at the end of every day, and you’d be good on
          your last drink of the day so long as you always had an Emergency
          Margarita in your inventory. But what if you didn’t? It turns out
          nightcaps can be a bit more complicated! Let’s add a check that
          purchases an emergency margarita for you, if you don’t have one lying
          around.
        </p>
        <div class="language-plaintext highlighter-rouge">
          <div class="highlight">
            <pre
              class="highlight"
            ><code>item nightcap = $item[emergency margarita]);

if (available_amount(nightcap) == 0) buy(1, nightcap);

drink(1, nightcap);
</code></pre>
          </div>
        </div>
        <p>
          But wait! What if a nefarious actor bought up every single emergency
          margarita in the mall? Computers are smart, but they’re also
          extraordinarily literal – if you tell it to purchase a margarita, it
          will do so, no matter how much meat they cost. Let’s add a catch that
          aborts if margaritas become way too expensive to justify.
        </p>

        <p>-insert code w/ mall catch &amp; abort-</p>

        <p>
          There’s another issue here – this code doesn’t actually take into
          account how much drunkenness you have. What if you actually forgot to
          drink a few points of liver before you ran the script? That might
          equate to lost adventures, and that just won’t do. Let’s add a
          function to this that fills your liver with splendid martinis before
          the margarita is consumed.
        </p>

        <p>-insert code w/ while loop on inebriety, with a catch function-</p>

        <p>
          Please note that while loops can be very dangerous; you need to make
          sure that what you are doing increments, and if it doesn’t, you need
          to include some sort of catch that allows it to break out of an
          infinite loop. Regardless, there’s one last issue here. What about
          Stooper, the familiar that gives you +1 drunkenness? Let’s make sure
          we’re equipping our little buddy for the extra turns.
        </p>

        <p>-add stooper support-</p>

        <p>
          Oh, wait. One last thing! Why not maximize our outfit for adventures,
          so that this can truly be the last thing we do for the day? Might as
          well, right?
        </p>

        <p>-add equipping lefty if you have him then modmax adventures-</p>

        <p>
          Fantastic. We have a script. We’ve used quite a few functions in this
          script,, including [insert list here]. When you’re building your own
          scripts, one of the best ways to learn is to simply pick a simple task
          and start thinking through what kind of complications could make a
          simple thing less straightforward. When you figure those out, and
          start solving them via mafia functions, you quickly turn a very simple
          one-line script into a larger scale construction that teaches you
          about all sorts of new functions and commands.
        </p>

        <h3 id="examples-of-high-level-ash-code">
          Examples of High-Level ASH Code
        </h3>
        <p>
          TheDictator (a player /dev) has many complex ASH scripts available on
          <a href="https://pastebin.com/u/thedictator">his pastebin</a>.
        </p>

        <p>
          <a
            href="https://github.com/Loathing-Associates-Scripting-Society/autoscend"
            >Autoscend</a
          >
          is a LASS-maintained general-use ascension script written in ASH.
        </p>

        <p>
          Notoriously prolific KoL scripter
          <a href="https://github.com/Ezandora">Ezandora</a> has scores of ASH
          scripts available on her github.
        </p>

        <h3 id="the-pros-and-cons-of-ash">The Pros and Cons of ASH</h3>
        <p>
          | Pros | Cons | | —- | —- | | Quick &amp; easy to use for short and
          simple scripts | Can get messy when doing more complicated processes |
          | Automatically can access all KoLMafia functions, doesn’t require
          importing | – |
        </p>

        <h2 id="javascript">Javascript</h2>

        <h3 id="why-javascript">Why Javascript?</h3>

        <p>
          The single biggest advantage that Javascript has over ASH is the fact
          that it is widely used for other things beyond KoL scripting. This
          means that when you come across a problem or a concept that doesn’t
          make sense, you will have the entirety of the internet’s collective
          Javascript knowledge to provide you an answer as opposed to just
          things specifically posted about on the KoLmafia forums. As an added
          bonus, it means that skills you hone while writing KoL scripts will be
          applicable elsewhere.
        </p>

        <h3 id="how-javascript">How Javascript?</h3>

        <p>
          This is a very silly question that I’ve put into your mouth, and so it
          gets a very silly answer. An answer to one interpretation of this
          question is Rhino, a Javascript engine written in Java (despite their
          names, these languages are unrelated), that Mafia uses to read
          Javascript, uh, scripts.
        </p>

        <p>
          An answer to another interpretation of this question is pretty similar
          to ASH: just start writing. When you write in Javascript, you’ll need
          to import any mafia functions you plan on using, by having a big chunk
          of text at the top of your script that essentially looks like this:
        </p>
        <div class="language-plaintext highlighter-rouge">
          <div class="highlight">
            <pre class="highlight"><code>const {
 adv1,
 availableAmount,
 buy,
 drink,
 eat,
 getProperty
} = require("kolmafia");
</code></pre>
          </div>
        </div>
        <p>
          Other than that, the world is pretty much your oyster. One thing to
          note is that you won’t need to import fundamental Object types used by
          KoLMafia: Item, Skill, Effect, Familiar, etc. You will, however, have
          to import any functions that use these types.
        </p>

        <p>
          One other important note: the KoLMafia Wiki was written to support
          ASH. This means that functions on the Mafia wiki are described using
          their ASH naming conventions (and with written-out ASH examples).
          Generally speaking, JS uses camel case (e.g. thisIsYourVariable) while
          ASH uses snake case (e.g. this_is_your_variable). Tactically, what
          this means is that when you access an ASH page to get information
          about a specific function (like, say,
          <a href="https://wiki.kolmafia.us/index.php/Elemental_resistance"
            >elemental_resistance</a
          >), you need to be cognizant of the fact that any JS script that
          references this function will require elementalResistance instead of
          elemental_resistance. It’s a small change, but important to keep in
          mind when using the wiki to inform your available functions.
        </p>

        <h3 id="improving-your-js-development-with-typescript">
          Improving your JS development with Typescript
        </h3>
        <p>
          “Hold on!”, you protest, “I have just learned about Javascript and it
          seems cool. Why would you introduce something new!” This is a fair
          criticism, and if you are trying to script simple actions you can
          probably stop here. That being said, maybe your appetite has been whet
          and you are ready to tackle a larger project. In these scenarios, it
          makes sense to consider Typescript. Typescript is a superset of
          Javascript, meaning that it has everything Javascript has, but it also
          has more! The primary advantage Typescript has over Javascript is that
          it has static typing, this is a programming concept which means, in
          practical terms, that you can catch certain errors when you are
          writing the code, as opposed to when KoLMafia is executing the code.
          This gets to be very important when you are dealing with a large
          script containing many functions and variables. However, this added
          functionality does not come for free. It comes at the cost of having
          to transpile, here meaning compiling your Typescript into Javascript
          so KoLmafia can understand it. This involves doing additional setup
          for the script you are writing.
        </p>

        <h3 id="linting-and-libram">Linting and Libram</h3>
      </section>
      <footer>
        <p>
          This project is maintained by
          <a href="https://github.com/Loathing-Associates-Scripting-Society"
            >Loathing-Associates-Scripting-Society</a
          >
        </p>

        <p>
          <small
            >Hosted on GitHub Pages &mdash; Theme by
            <a href="https://github.com/orderedlist">orderedlist</a></small
          >
        </p>
      </footer>
    </div>
    <script src="/assets/js/scale.fix.js"></script>
  </body>
</html>
